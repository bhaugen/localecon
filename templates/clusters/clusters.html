{% extends "base.html" %}
{% load permissions %}

{% block title %}
     Clusters
{% endblock %}

<style>
	.description p {
		margin: 0 0 0 1em;
		font-size: 90%;
	}
</style>


{% block content %}
<div style="float: left; ">
	<h3>Communities and Clusters</h3>
</div>

<div id="rightLinks" style="float: right; width: 130px;">
	<ul>
	{% if user.is_authenticated %}
		<li>{{ user }} <a class="regularLink" href="{% url acct_logout %}">Logout</a></li>
		<li><a class="regularLink" href="/help/">Help</a></li>
		{% if user.is_staff %}
			<li><a class="regularLink" href="/admin">Admin</a></li>
		{% endif %}
		<li><a class="regularLink" href="/about/">About</a></li>
		<li><a class="hiliteLink" href="{% url clusters %}">View All Clusters</a></li>
	{% else %}
		<li><a class="regularLink" href="{% url acct_login %}">Log in</a></li>
		<li><a class="regularLink" href="/about/">About</a></li>
		<li><a class="hiliteLink" href="{% url clusters %}">View All Clusters</a></li>
	{% endif %}
	</ul>
</div>

<div style="clear: both;"></div>
<div style="float: left; ">
	{% if user.is_superuser %}
	<form action="{% url new_community  %}" method="GET">
    	<input type="submit" value="New Community" />
	</form>
	{% endif %}
		<ul>
			{% for community in communities  %}
				{% if community.is_public %}
				<li class="community" >
					{{ community }} Community
					{% community_perms user edit community as can_edit %}
					{% if can_edit %}
					&nbsp;&nbsp;
					<form style="display:inline;" action="{% url edit_community community_id=community.id %}" method="GET">
						<input type="submit" value="Edit Community" />
					</form>
					<form style="display:inline;" action="{% url new_cluster community_id=community.id %}" method="GET">
						<input type="submit" value="New Cluster" />
					</form>
					{% endif %}
					{% if community.description %}
					<div class="description">
						{{ community.description|linebreaks }}
					</div>
					{% endif %}
				</li>
				{% if community.clusters.all %}
					<ul>
						{% for cluster in community.clusters.all %}
							{% if cluster.is_public or user.is_authenticated %}
							<li class="cluster" >
								{{ cluster.name }}</a> Cluster:&nbsp;&nbsp;
								{% include "clusters/_simple_cluster_nav.html" %}
								{% if cluster.description %}
									<div class="description">
										{{ cluster.description|linebreaks }}
									</div>
								{% endif %}
							</li>
							{% endif %}
						{% endfor %}
					</ul>
				{% endif %}
				{% endif %}
			{% endfor %}
		</ul>
</div>

<div style="clear: both;"></div>
 
{% endblock %} 
