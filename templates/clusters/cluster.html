{% extends "base.html" %}

{% block title %}
     Cluster: {{ cluster }}
{% endblock %}

{% block header %}

<script type="text/javascript"
      src="http://maps.googleapis.com/maps/api/js?key={{ map_key }}&sensor=false">
</script>


<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>

<script type="text/javascript">
	
	
	function initialize() {
        var myOptions = {
          center: new google.maps.LatLng({{ map_center }}),
          zoom: {{ zoom_level }},
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var map = new google.maps.Map(document.getElementById("map_canvas"),
            myOptions);
	
		{% for agent in agents %}
	
			var contentString = '<div id="content">'+
			    '<div id="siteNotice">'+
				'</div>'+
				'<h2 id="firstHeading" class="firstHeading">{{ agent.name }}</h2>'+
				'<div id="bodyContent">'+
				'<p><b>Uluru</b>, also referred to as <b>Ayers Rock</b>, is a large ' +
			    'Heritage Site.</p>'+
			    '</div>'+
				'</div>';

			var infowindow = new google.maps.InfoWindow({
				content: contentString
			});
	
			var location = new google.maps.LatLng({{ agent.lat_lng }});
			var marker = new google.maps.Marker({
				position: location,
				map: map,
				title: "{{ agent.name }}"
			});
	
			google.maps.event.addListener(marker, 'click', function() {
			  infowindow.open(map,marker);
			});
	
		{% endfor %}
	}
	
	$(document).ready(function() {
		initialize();
	});
</script>

{% endblock %}

{% block content %}

<div class="map">

{% include "clusters/_cluster_nav.html" %}

<h3>Cluster: {{ cluster }}</h3>

<p>
	{{ cluster.description }}<br />

</p>

<div id="map_canvas" style="height: 550px; width: 1000px;" ></div>

</div>

{% endblock %}
